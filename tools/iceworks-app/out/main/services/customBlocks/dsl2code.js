const e=require("@iceland/dsl2code").default,i=require("../../utils/codeFormat"),n=require("../../glodlog"),s=require("../settings");module.exports=((a,o,r)=>{const c=s.get("isAlibaba");n.record({type:"app",action:"iceland-save-block",group:c?"alibaba":"outer"}),e(a,{format:!1,componentMode:!0,packageAlias:[{npmName:"@alife/next",npmAlias:"@icedesign/base",version:"^0.2.3"}]},o,"react").then(e=>{const{codeFileTree:n={},deps:s}=e.codeResult;let a=[];-1!==s.indexOf("@icedesign/base")&&(s.splice(s.indexOf("@icedesign/base"),1),a.push({npmName:"@icedesign/base",version:"^0.2.3"})),-1!==s.indexOf("react-dom")&&s.splice(s.indexOf("react-dom"),1);const c=s.map(e=>o.npmNameToSource[e]);a=a.concat(c.map(e=>({npmName:e.npmName,version:e.version})));const t=JSON.stringify(a);n["index.jsx"]=i(n["index.jsx"],{parser:"babylon"});const d=JSON.stringify(n);return r(t,d)})});