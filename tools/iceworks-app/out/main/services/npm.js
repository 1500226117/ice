const{exec:e}=require("child_process"),{getEnv:s}=require("../env"),r=require("../logger"),n=require("./sessions/Session");class t extends Error{constructor(e,s){super(e),this.metadata=s}}const o={exec(r,n={},t){e(r,Object.assign(n,{env:s()}),t)},run(e,s){"string"==typeof e&&(e=e.split(" "));const o=s.cwd;return r.debug("npm",e.join(" "),o),e.push("--scripts-prepend-node-path=auto"),new Promise((s,r)=>{new n({cwd:o,shell:"npm",shellArgs:e}).on("exit",n=>{0===n?s(n):r(new t("runcmd",{cmd:"npm",args:e}))})})}};module.exports=o;